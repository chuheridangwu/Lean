# 数据链路层
链路: 从1个节点到相邻节点的一段物理线路（有线或无线）,中间没有其他交换节点。例如下面这张图,
![](../network/imgs/network_36.jpg)
◼ 数据链路：在一条链路上传输数据时，需要有对应的通信协议来控制数据的传输
不同类型的数据链路，所用的通信协议可能是不同的
✓ 广播信道：CSMA/CD协议（比如同轴电缆、集线器等组成的网络）
✓ 点对点信道：PPP协议（比如2个路由器之间的信道）
◼ 数据链路层的3个基本问题
封装成帧
透明传输
差错检验

## 封装成帧
将网络层传过来的数据包封装成帧，最大传输单元MTU，1500字节。

## 透明传输
在传输链路上有多个帧数据，只能知道每个帧具体的大小，这个时候就要有帧开始符和帧结束符，为了预防数据里也有帧开始符和帧结束符，只要有，就在数据前使用ESC进行填充。

>以太网帧V2的版本，如果使用曼彻斯特编码，只要发现没有信号跳变，就认为帧结束

## 差错检验
为什么要有差错检验，在信道传输的过程中，如果受到干扰可能会造成失真，差错检验防止拿到失真的数据。

差错检验的方法，使用帧的数据和数据链路层首部计算出一个FCS，网卡拿到数据之后，会再对数据进行计算，如果FCS一致，网卡会继续往上传，如果不一致，网卡会将这个数据丢弃

## CSMA/CD 协议


## 以太网帧


## PPP 协议
点对点信道使用的是PPP协议,意思是这条线路一定是从A到B，点对点链路不需要源MAC地址和目标MAC地址

PPP 帧

## 网卡
网卡接收到一个帧，首先会进行差错校验，如果校验通过则接收，否则丢弃。

* `Wireshark`抓到的帧没有`FCS` ，因为它抓到的是差错校验通过的帧（帧尾的FCS会被硬件去掉）
* `Wireshark`抓不到差错校验失败的帧, 校验失败的帧已经被网卡丢弃了
![](../network/imgs/network_35.jpg)
